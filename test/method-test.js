const test = require('ava')
const pdfmake = require('../src/index')
const template = require('./data/template.json')
const templateDemo = require('./data/template-demo.json')
const bufferToBase64 = buffer => 'data:application/pdf;base64,' + buffer.toString('base64')

test('make-pdf', async t => {
  const expected = 'data:application/pdf;base64,JVBERi0xLjMKJf////8KOCAwIG9iago8PAovVHlwZSAvRXh0R1N0YXRlCi9jYSAxCi9DQSAxCj4+CmVuZG9iago3IDAgb2JqCjw8Ci9UeXBlIC9QYWdlCi9QYXJlbnQgMSAwIFIKL01lZGlhQm94IFswIDAgNTk1LjI4IDg0MS44OV0KL0NvbnRlbnRzIDUgMCBSCi9SZXNvdXJjZXMgNiAwIFIKPj4KZW5kb2JqCjYgMCBvYmoKPDwKL1Byb2NTZXQgWy9QREYgL1RleHQgL0ltYWdlQiAvSW1hZ2VDIC9JbWFnZUldCi9FeHRHU3RhdGUgPDwKL0dzMSA4IDAgUgo+PgovRm9udCA8PAovRjEgOSAwIFIKPj4KPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0xlbmd0aCA0NzkKL0ZpbHRlciAvRmxhdGVEZWNvZGUKPj4Kc3RyZWFtCnicxZbPjhMxDMbveYq8AN7YieNYWvWwYlmJG2huiMMybREHkFClfX6cmXTFn5JBqAFVX0eNZprffLG/BH2wzwu0r5IQivr5s7t5OKH/eHI3Lw9Pn+bD24c7P59cWG49zV/c0X11eOnBu6mNo0/BiwYQFizFT/anr9Aj+eno3t2GENBEpmhKJjblnQ/v/fTa3U/uzVUocoZcImvqw4ipVJidRwWOSOxv25j+Zrw+83h14GqbGLSmfJH0g2k27Ztlj6ZDs/H69hUGwqCx9KH+2j7TcQg4pgQspU7YJT9bSK0KB5BkARSRmLZJaG2LZUEHkGiEwpyy9knKkNkpRIgcGXN3djznAq9afo/xg0iBapHEPhF9RzSAIjGIkm6syuLDvjW/Dm16KgSkGDZWKvDOK0jm3Lp6P4ZGGTQUK5++P2GtXIw/UY2pnUgFKOWgG11tmYJpTUArtpoC6ZlqTPJFrlse5oT/O/mi2CtvRvBzw8/DFisFhMDL9F2ScwRjoxpAQghSu122I2eQF1GgRC2pX7iYmxfSrnklWq4DqKxUMEgi6hftuU7+TfRwoD/ZIJYNc8zmwMiQpSJs99ChkYw7TNezaSbIkS6forn10JjVsJmFUTl2IX6Jk/QDyDfu081UCmVuZHN0cmVhbQplbmRvYmoKMTEgMCBvYmoKKHBkZm1ha2UpCmVuZG9iagoxMiAwIG9iagoocGRmbWFrZSkKZW5kb2JqCjEzIDAgb2JqCihEOjIwMTkwOTI4MjMzNTAwWikKZW5kb2JqCjEwIDAgb2JqCjw8Ci9Qcm9kdWNlciAxMSAwIFIKL0NyZWF0b3IgMTIgMCBSCi9DcmVhdGlvbkRhdGUgMTMgMCBSCj4+CmVuZG9iagoxNSAwIG9iago8PAovVHlwZSAvRm9udERlc2NyaXB0b3IKL0ZvbnROYW1lIC9BWlpaWlorUm9ib3RvLVJlZ3VsYXIKL0ZsYWdzIDQKL0ZvbnRCQm94IFstNzM2LjgxNjQwNiAtMjcwLjk5NjA5NCAxMTQ4LjQzNzUgMTA1Ni4xNTIzNDRdCi9JdGFsaWNBbmdsZSAwCi9Bc2NlbnQgOTI3LjczNDM3NQovRGVzY2VudCAtMjQ0LjE0MDYyNQovQ2FwSGVpZ2h0IDcxMC45Mzc1Ci9YSGVpZ2h0IDUyOC4zMjAzMTMKL1N0ZW1WIDAKL0ZvbnRGaWxlMiAxNCAwIFIKPj4KZW5kb2JqCjE2IDAgb2JqCjw8Ci9UeXBlIC9Gb250Ci9TdWJ0eXBlIC9DSURGb250VHlwZTIKL0Jhc2VGb250IC9BWlpaWlorUm9ib3RvLVJlZ3VsYXIKL0NJRFN5c3RlbUluZm8gPDwKL1JlZ2lzdHJ5IChBZG9iZSkKL09yZGVyaW5nIChJZGVudGl0eSkKL1N1cHBsZW1lbnQgMAo+PgovRm9udERlc2NyaXB0b3IgMTUgMCBSCi9XIFswIFs5MDggNTUyLjczNDM3NSAyNDIuNjc1NzgxIDMzOC4zNzg5MDYgNTE1LjYyNSAzMjYuNjYwMTU2IDI0Ny41NTg1OTQgNTYxLjAzNTE1NiA1NDMuOTQ1MzEzIDU2MS4wMzUxNTYgNTUwLjc4MTI1IDY1Mi4zNDM3NSA1NTEuNzU3ODEzIDU3MC4zMTI1IDUyOS43ODUxNTYgMTk2LjI4OTA2MyA4NzYuNDY0ODQ0IDI0Mi42NzU3ODEgNTYxLjAzNTE1NiA1MDYuODM1OTM4IDU1MS4yNjk1MzEgNzUxLjQ2NDg0NCA1NjMuOTY0ODQ0IDQ4NC4zNzVdXQo+PgplbmRvYmoKMTcgMCBvYmoKPDwKL0xlbmd0aCAyODEKL0ZpbHRlciAvRmxhdGVEZWNvZGUKPj4Kc3RyZWFtCnicXZFNa4QwEIbv+RVz3B4WV7s1LUigbC8e+kFt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'
  const actual = bufferToBase64(await pdfmake(template))
  t.is(actual.substring(0, 200), expected.substring(0, 200))
})

test('make-pdf demo', async t => {
  await pdfmake(templateDemo)
  t.pass()
})
